'use strict';

var _ = require('lodash');
var async = require('async');
var util = require('util');
var objectHash = require('object-hash');
var readlineSync = require('readline-sync');
var deepDiff = require('deep-diff').diff;

var buildError = require('../orm/apollo_error.js');
var schemer = require('../validators/schema');
var parser = require('../utils/parser');
var normalizer = require('../utils/normalizer');

var ElassandraBuilder = require('./elassandra');

var TableBuilder = function f(driver, properties) {
  this._driver = driver;
  this._properties = properties;
  if (this._properties.esclient) {
    this._es_builder = new ElassandraBuilder(this._properties.esclient);
  }
};

TableBuilder.prototype = {
  _confirm_migration(message) {
    var permission = 'y';
    if (message && !this._properties.disableTTYConfirmation) {
      permission = readlineSync.question(util.format('Migration: %s (y/n): ', message));
    }
    return permission.toLowerCase();
  },
  get_table(callback) {
    var properties = this._properties;
    var keyspaceName = properties.keyspace;
    var tableName = properties.table_name;
    var dbSchema = { fields: {}, typeMaps: {}, staticMaps: {} };
    var query = 'SELECT * FROM system_schema.columns WHERE table_name = ? AND keyspace_name = ?;';

    this._driver.execute_query(query, [tableName, keyspaceName], function (err, resultColumns) {
      if (err) {
        callback(buildError('model.tablecreation.dbschemaquery', err));
        return;
      }

      if (!resultColumns.rows || resultColumns.rows.length === 0) {
        callback();
        return;
      }

      for (var r = 0; r < resultColumns.rows.length; r++) {
        var row = resultColumns.rows[r];

        dbSchema.fields[row.column_name] = parser.extract_type(row.type);

        var typeMapDef = parser.extract_typeDef(row.type);
        if (typeMapDef.length > 0) {
          dbSchema.typeMaps[row.column_name] = typeMapDef;
        }

        if (row.kind === 'partition_key') {
          if (!dbSchema.key) dbSchema.key = [[]];
          dbSchema.key[0][row.position] = row.column_name;
        } else if (row.kind === 'clustering') {
          if (!dbSchema.key) dbSchema.key = [[]];
          if (!dbSchema.clustering_order) dbSchema.clustering_order = {};

          dbSchema.key[row.position + 1] = row.column_name;
          if (row.clustering_order && row.clustering_order.toLowerCase() === 'desc') {
            dbSchema.clustering_order[row.column_name] = 'DESC';
          } else {
            dbSchema.clustering_order[row.column_name] = 'ASC';
          }
        } else if (row.kind === 'static') {
          dbSchema.staticMaps[row.column_name] = true;
        }
      }

      callback(null, dbSchema);
    });
  },

  get_table_schema(callback) {
    var _this = this;

    this.get_table(function (err, dbSchema) {
      if (err) {
        callback(err);
        return;
      }
      if (!dbSchema) {
        callback();
        return;
      }
      _this.get_indexes(function (err1, indexSchema) {
        if (err1) {
          callback(err1);
          return;
        }
        _this.get_mviews(function (err2, viewSchema) {
          if (err2) {
            callback(err2);
            return;
          }
          Object.assign(dbSchema, indexSchema, viewSchema);
          callback(null, dbSchema);
        });
      });
    });
  },

  create_table(schema, callback) {
    var properties = this._properties;
    var tableName = properties.table_name;
    var rows = [];
    var fieldType = void 0;
    Object.keys(schema.fields).forEach(function (k) {
      if (schema.fields[k].virtual) {
        return;
      }
      var segment = '';
      fieldType = schemer.get_field_type(schema, k);
      if (schema.fields[k].typeDef) {
        segment = util.format('"%s" %s%s', k, fieldType, schema.fields[k].typeDef);
      } else {
        segment = util.format('"%s" %s', k, fieldType);
      }

      if (schema.fields[k].static) {
        segment += ' STATIC';
      }

      rows.push(segment);
    });

    var clauses = parser.get_primary_key_clauses(schema);

    var query = util.format('CREATE TABLE IF NOT EXISTS "%s" (%s , PRIMARY KEY((%s)%s))%s;', tableName, rows.join(' , '), clauses.partitionKeyClause, clauses.clusteringKeyClause, clauses.clusteringOrderClause);

    this._driver.execute_definition_query(query, function (err, result) {
      if (err) {
        callback(buildError('model.tablecreation.dbcreate', err));
        return;
      }
      callback(null, result);
    });
  },

  alter_table(operation, fieldname, type, callback) {
    var properties = this._properties;
    var tableName = properties.table_name;
    if (operation === 'ALTER') type = util.format('TYPE %s', type);else if (operation === 'DROP') type = '';

    var query = util.format('ALTER TABLE "%s" %s "%s" %s;', tableName, operation, fieldname, type);
    this._driver.execute_definition_query(query, callback);
  },

  _drop_table(tableName, callback) {
    var query = util.format('DROP TABLE IF EXISTS "%s";', tableName);
    this._driver.execute_definition_query(query, function (err) {
      if (err) {
        callback(buildError('model.tablecreation.dbdrop', err));
        return;
      }
      callback();
    });
  },

  drop_table(materializedViews, callback) {
    var _this2 = this;

    var properties = this._properties;
    var tableName = properties.table_name;
    var message = util.format('Schema for table "%s" has changed in a way where alter migration is not possible, all data in the table will be lost, are you sure you want to drop the table?', tableName);
    var permission = this._confirm_migration(message);
    if (permission !== 'y') {
      callback(buildError('model.tablecreation.schemamismatch', tableName, 'migration suspended, please apply the change manually'));
      return;
    }
    if (!materializedViews) {
      this._drop_table(tableName, callback);
      return;
    }

    var mviews = Object.keys(materializedViews);
    this.drop_mviews(mviews, function (err) {
      if (err) {
        callback(err);
        return;
      }

      _this2._drop_table(tableName, callback);
    });
  },

  drop_recreate_table(modelSchema, materializedViews, callback) {
    var _this3 = this;

    if (this._es_builder) {
      this._es_builder.delete_index(this._properties.keyspace, function () {
        _this3.drop_table(materializedViews, function (err1) {
          if (err1) {
            callback(err1);
            return;
          }
          _this3.create_table(modelSchema, callback);
        });
      });
      return;
    }
    this.drop_table(materializedViews, function (err1) {
      if (err1) {
        callback(err1);
        return;
      }
      _this3.create_table(modelSchema, callback);
    });
  },

  get_indexes(callback) {
    var properties = this._properties;
    var keyspaceName = properties.keyspace;
    var tableName = properties.table_name;
    var dbSchema = {};
    var query = 'SELECT * FROM system_schema.indexes WHERE table_name = ? AND keyspace_name = ?;';

    this._driver.execute_query(query, [tableName, keyspaceName], function (err, resultIndexes) {
      if (err) {
        callback(buildError('model.tablecreation.dbschemaquery', err));
        return;
      }

      for (var r = 0; r < resultIndexes.rows.length; r++) {
        var row = resultIndexes.rows[r];

        if (row.index_name && row.options.target) {
          var indexOptions = row.options;
          var target = indexOptions.target;
          target = target.replace(/["\s]/g, '');
          delete indexOptions.target;

          // keeping track of index names to drop index when needed
          if (!dbSchema.index_names) dbSchema.index_names = {};

          if (row.kind === 'CUSTOM') {
            var using = indexOptions.class_name;
            delete indexOptions.class_name;

            if (!dbSchema.custom_indexes) dbSchema.custom_indexes = [];
            var customIndexObject = {
              on: target,
              using,
              options: indexOptions
            };
            dbSchema.custom_indexes.push(customIndexObject);
            dbSchema.index_names[objectHash(customIndexObject)] = row.index_name;
          } else {
            if (!dbSchema.indexes) dbSchema.indexes = [];
            dbSchema.indexes.push(target);
            dbSchema.index_names[target] = row.index_name;
          }
        }
      }

      callback(null, dbSchema);
    });
  },

  _create_index_query(tableName, indexName) {
    var query = void 0;
    var indexExpression = indexName.replace(/["\s]/g, '').split(/[()]/g);
    if (indexExpression.length > 1) {
      indexExpression[0] = indexExpression[0].toLowerCase();
      query = util.format('CREATE INDEX IF NOT EXISTS ON "%s" (%s("%s"));', tableName, indexExpression[0], indexExpression[1]);
    } else {
      query = util.format('CREATE INDEX IF NOT EXISTS ON "%s" ("%s");', tableName, indexExpression[0]);
    }
    return query;
  },

  create_indexes(indexes, callback) {
    var _this4 = this;

    var properties = this._properties;
    var tableName = properties.table_name;
    async.eachSeries(indexes, function (idx, next) {
      var query = _this4._create_index_query(tableName, idx);
      _this4._driver.execute_definition_query(query, function (err, result) {
        if (err) next(buildError('model.tablecreation.dbindexcreate', err));else next(null, result);
      });
    }, callback);
  },

  _create_custom_index_query(tableName, customIndex) {
    var query = util.format('CREATE CUSTOM INDEX IF NOT EXISTS ON "%s" ("%s") USING \'%s\'', tableName, customIndex.on, customIndex.using);

    if (Object.keys(customIndex.options).length > 0) {
      query += ' WITH OPTIONS = {';
      Object.keys(customIndex.options).forEach(function (key) {
        query += util.format("'%s': '%s', ", key, customIndex.options[key]);
      });
      query = query.slice(0, -2);
      query += '}';
    }

    query += ';';

    return query;
  },

  create_custom_indexes(customIndexes, callback) {
    var _this5 = this;

    var properties = this._properties;
    var tableName = properties.table_name;
    async.eachSeries(customIndexes, function (idx, next) {
      var query = _this5._create_custom_index_query(tableName, idx);
      _this5._driver.execute_definition_query(query, function (err, result) {
        if (err) next(buildError('model.tablecreation.dbindexcreate', err));else next(null, result);
      });
    }, callback);
  },

  drop_indexes(indexes, callback) {
    var _this6 = this;

    async.each(indexes, function (idx, next) {
      var query = util.format('DROP INDEX IF EXISTS "%s";', idx);
      _this6._driver.execute_definition_query(query, next);
    }, function (err) {
      if (err) callback(buildError('model.tablecreation.dbindexdrop', err));else callback();
    });
  },

  get_mviews(callback) {
    var _this7 = this;

    var properties = this._properties;
    var keyspaceName = properties.keyspace;
    var tableName = properties.table_name;
    var dbSchema = {};
    var query = 'SELECT view_name,base_table_name,where_clause FROM system_schema.views WHERE keyspace_name=? AND base_table_name=? ALLOW FILTERING;';

    this._driver.execute_query(query, [keyspaceName, tableName], function (err, resultViews) {
      if (err) {
        callback(buildError('model.tablecreation.dbschemaquery', err));
        return;
      }

      for (var r = 0; r < resultViews.rows.length; r++) {
        var row = resultViews.rows[r];

        if (row.view_name) {
          if (!dbSchema.materialized_views) dbSchema.materialized_views = {};
          dbSchema.materialized_views[row.view_name] = {
            where_clause: row.where_clause
          };
        }
      }

      if (!dbSchema.materialized_views) {
        callback(null, dbSchema);
        return;
      }

      query = 'SELECT * FROM system_schema.columns WHERE keyspace_name=? and table_name IN ?;';

      var viewNames = Object.keys(dbSchema.materialized_views);
      _this7._driver.execute_query(query, [keyspaceName, viewNames], function (err1, resultMatViews) {
        if (err1) {
          callback(buildError('model.tablecreation.dbschemaquery', err1));
          return;
        }

        for (var _r = 0; _r < resultMatViews.rows.length; _r++) {
          var _row = resultMatViews.rows[_r];

          if (!dbSchema.materialized_views[_row.table_name].select) {
            dbSchema.materialized_views[_row.table_name].select = [];
          }

          dbSchema.materialized_views[_row.table_name].select.push(_row.column_name);

          if (_row.kind === 'partition_key') {
            if (!dbSchema.materialized_views[_row.table_name].key) {
              dbSchema.materialized_views[_row.table_name].key = [[]];
            }

            dbSchema.materialized_views[_row.table_name].key[0][_row.position] = _row.column_name;
          } else if (_row.kind === 'clustering') {
            if (!dbSchema.materialized_views[_row.table_name].key) {
              dbSchema.materialized_views[_row.table_name].key = [[]];
            }
            if (!dbSchema.materialized_views[_row.table_name].clustering_order) {
              dbSchema.materialized_views[_row.table_name].clustering_order = {};
            }

            dbSchema.materialized_views[_row.table_name].key[_row.position + 1] = _row.column_name;
            if (_row.clustering_order && _row.clustering_order.toLowerCase() === 'desc') {
              dbSchema.materialized_views[_row.table_name].clustering_order[_row.column_name] = 'DESC';
            } else {
              dbSchema.materialized_views[_row.table_name].clustering_order[_row.column_name] = 'ASC';
            }
          }
        }

        callback(null, dbSchema);
      });
    });
  },

  _create_materialized_view_query(tableName, viewName, viewSchema) {
    var rows = [];

    for (var k = 0; k < viewSchema.select.length; k++) {
      if (viewSchema.select[k] === '*') rows.push(util.format('%s', viewSchema.select[k]));else rows.push(util.format('"%s"', viewSchema.select[k]));
    }

    var whereClause = viewSchema.where_clause || parser.get_mview_where_clause(this._properties.schema, viewSchema);
    var clauses = parser.get_primary_key_clauses(viewSchema);

    var query = util.format('CREATE MATERIALIZED VIEW IF NOT EXISTS "%s" AS SELECT %s FROM "%s" WHERE %s PRIMARY KEY((%s)%s)%s;', viewName, rows.join(' , '), tableName, whereClause, clauses.partitionKeyClause, clauses.clusteringKeyClause, clauses.clusteringOrderClause);

    return query;
  },

  create_mviews(materializedViews, callback) {
    var _this8 = this;

    var properties = this._properties;
    var tableName = properties.table_name;
    async.eachSeries(Object.keys(materializedViews), function (viewName, next) {
      var query = _this8._create_materialized_view_query(tableName, viewName, materializedViews[viewName]);
      _this8._driver.execute_definition_query(query, function (err, result) {
        if (err) next(buildError('model.tablecreation.matviewcreate', err));else next(null, result);
      });
    }, callback);
  },

  drop_mviews(mviews, callback) {
    var _this9 = this;

    async.each(mviews, function (view, next) {
      var query = util.format('DROP MATERIALIZED VIEW IF EXISTS "%s";', view);
      _this9._driver.execute_definition_query(query, next);
    }, function (err) {
      if (err) callback(buildError('model.tablecreation.matviewdrop', err));else callback();
    });
  },

  _apply_alter_operations(alterOperations, dbSchema, normalizedModelSchema, normalizedDBSchema, callback) {
    var _this10 = this;

    // it should create/drop indexes/custom_indexes/materialized_views that are added/removed in model schema
    // remove common indexes/custom_indexes/materialized_views from normalizedModelSchema and normalizedDBSchema
    // then drop all remaining indexes/custom_indexes/materialized_views from normalizedDBSchema
    // and add all remaining indexes/custom_indexes/materialized_views from normalizedModelSchema
    var properties = this._properties;
    var tableName = properties.table_name;
    var addedIndexes = _.difference(normalizedModelSchema.indexes, normalizedDBSchema.indexes);
    var removedIndexes = _.difference(normalizedDBSchema.indexes, normalizedModelSchema.indexes);
    var removedIndexNames = [];
    removedIndexes.forEach(function (removedIndex) {
      removedIndexNames.push(dbSchema.index_names[removedIndex]);
    });

    var addedCustomIndexes = _.filter(normalizedModelSchema.custom_indexes, function (obj) {
      return !_.find(normalizedDBSchema.custom_indexes, obj);
    });
    var removedCustomIndexes = _.filter(normalizedDBSchema.custom_indexes, function (obj) {
      return !_.find(normalizedModelSchema.custom_indexes, obj);
    });
    removedCustomIndexes.forEach(function (removedIndex) {
      removedIndexNames.push(dbSchema.index_names[objectHash(removedIndex)]);
    });

    var addedMaterializedViewsNames = _.filter(Object.keys(normalizedModelSchema.materialized_views), function (viewName) {
      return !_.isEqual(normalizedDBSchema.materialized_views[viewName], normalizedModelSchema.materialized_views[viewName]);
    });

    var removedMaterializedViewNames = _.filter(Object.keys(normalizedDBSchema.materialized_views), function (viewName) {
      return !_.isEqual(normalizedDBSchema.materialized_views[viewName], normalizedModelSchema.materialized_views[viewName]);
    });

    var addedMaterializedViews = {};
    addedMaterializedViewsNames.forEach(function (viewName) {
      addedMaterializedViews[viewName] = normalizedModelSchema.materialized_views[viewName];
    });

    // remove altered materialized views
    if (removedMaterializedViewNames.length > 0) {
      var message = util.format('Schema for table "%s" has removed materialized_views: %j, are you sure you want to drop them?', tableName, removedMaterializedViewNames);
      var permission = this._confirm_migration(message);
      if (permission !== 'y') {
        callback(buildError('model.tablecreation.schemamismatch', tableName, 'migration suspended, please apply the change manually'));
        return;
      }
    }

    this.drop_mviews(removedMaterializedViewNames, function (err2) {
      if (err2) {
        callback(err2);
        return;
      }

      if (removedIndexNames.length > 0) {
        var _message = util.format('Schema for table "%s" has removed indexes: %j, are you sure you want to drop them?', tableName, removedIndexNames);
        var _permission = _this10._confirm_migration(_message);
        if (_permission !== 'y') {
          callback(buildError('model.tablecreation.schemamismatch', tableName, 'migration suspended, please apply the change manually'));
          return;
        }
      }

      // remove altered indexes by index name
      _this10.drop_indexes(removedIndexNames, function (err3) {
        if (err3) {
          callback(err3);
          return;
        }

        // now apply alterOperations here
        async.eachSeries(alterOperations, function (alterOperation, next) {
          var permission = _this10._confirm_migration(alterOperation.message);
          if (permission !== 'y') {
            callback(buildError('model.tablecreation.schemamismatch', tableName, 'migration suspended, please apply the change manually'));
            return;
          }
          _this10.alter_table(alterOperation.operation, alterOperation.fieldName, alterOperation.type, next);
        }, function (err4) {
          if (err4) {
            callback(err4);
            return;
          }

          // add altered indexes
          // eslint-disable-next-line max-nested-callbacks
          _this10.create_indexes(addedIndexes, function (err5) {
            if (err5) {
              callback(err5);
              return;
            }

            // add altered custom indexes
            // eslint-disable-next-line max-nested-callbacks
            _this10.create_custom_indexes(addedCustomIndexes, function (err6) {
              if (err6) {
                callback(err6);
                return;
              }

              // add altered materialized_views
              _this10.create_mviews(addedMaterializedViews, callback);
            });
          });
        });
      });
    });
  },

  init_alter_operations(modelSchema, dbSchema, normalizedModelSchema, normalizedDBSchema, callback) {
    var _this11 = this;

    var properties = this._properties;
    var tableName = properties.table_name;
    var alterOperations = [];
    var differences = deepDiff(normalizedDBSchema.fields, normalizedModelSchema.fields);
    var droppedFields = false;
    async.eachSeries(differences, function (diff, next) {
      var fieldName = diff.path[0];
      if (diff.kind === 'N') {
        var message = util.format('Schema for table "%s" has added field "%s", are you sure you want to alter to add the field?', tableName, fieldName);
        alterOperations.push({
          fieldName,
          message,
          operation: 'ADD',
          type: parser.extract_altered_type(normalizedModelSchema, diff)
        });
        next();
        return;
      }
      if (diff.kind === 'D') {
        var _message2 = util.format('Schema for table "%s" has removed field "%s", all data in the field will lost, are you sure you want to alter to drop the field?', tableName, fieldName);
        alterOperations.push({
          fieldName,
          message: _message2,
          operation: 'DROP'
        });
        droppedFields = true;
        normalizer.remove_dependent_views_from_normalized_schema(normalizedDBSchema, dbSchema, fieldName);
        next();
        return;
      }
      if (diff.kind === 'E') {
        // check if the alter field type is possible, otherwise try D and then N
        if (diff.path[1] === 'type') {
          // check if field part of primary key
          if (normalizedDBSchema.key[0].includes(fieldName) || normalizedDBSchema.key.indexOf(fieldName) > 0) {
            // alter field type impossible
            next(new Error('alter_impossible'));
          } else if (['text', 'ascii', 'bigint', 'boolean', 'decimal', 'double', 'float', 'inet', 'int', 'timestamp', 'timeuuid', 'uuid', 'varchar', 'varint'].includes(diff.lhs) && diff.rhs === 'blob') {
            // alter field type possible
            var _message3 = util.format('Schema for table "%s" has new type for field "%s", are you sure you want to alter to update the field type?', tableName, fieldName);
            alterOperations.push({
              fieldName,
              message: _message3,
              operation: 'ALTER',
              type: diff.rhs
            });
            next();
          } else if (diff.lhs === 'int' && diff.rhs === 'varint') {
            // alter field type possible
            var _message4 = util.format('Schema for table "%s" has new type for field "%s", are you sure you want to alter to update the field type?', tableName, fieldName);
            alterOperations.push({
              fieldName,
              message: _message4,
              operation: 'ALTER',
              type: diff.rhs
            });
            next();
          } else if (diff.lhs === 'timeuuid' && diff.rhs === 'uuid') {
            // alter field type possible
            var _message5 = util.format('Schema for table "%s" has new type for field "%s", are you sure you want to alter to update the field type?', tableName, fieldName);
            alterOperations.push({
              fieldName,
              message: _message5,
              operation: 'ALTER',
              type: diff.rhs
            });
            next();
          } else {
            // alter type impossible
            var _message6 = util.format('Schema for table "%s" has new type for field "%s", all data in the field will be lost, are you sure you want to drop the field & recreate it?', tableName, fieldName);
            alterOperations.push({
              fieldName,
              message: _message6,
              operation: 'DROP'
            });
            alterOperations.push({
              fieldName,
              operation: 'ADD',
              type: parser.extract_altered_type(normalizedModelSchema, diff)
            });
            droppedFields = true;
            normalizer.remove_dependent_views_from_normalized_schema(normalizedDBSchema, dbSchema, fieldName);
            next();
          }
        } else {
          // alter type impossible
          var _message7 = util.format('Schema for table "%s" has new type for field "%s", all data in the field will be lost, are you sure you want to drop the field & recreate it?', tableName, fieldName);
          alterOperations.push({
            fieldName,
            message: _message7,
            operation: 'DROP'
          });
          alterOperations.push({
            fieldName,
            operation: 'ADD',
            type: parser.extract_altered_type(normalizedModelSchema, diff)
          });
          droppedFields = true;
          normalizer.remove_dependent_views_from_normalized_schema(normalizedDBSchema, dbSchema, fieldName);
          next();
        }
        return;
      }

      next();
    }, function (err) {
      if (err) {
        callback(err);
        return;
      }
      if (droppedFields && _this11._es_builder) {
        _this11._es_builder.delete_index(properties.keyspace, function () {
          _this11._apply_alter_operations(alterOperations, dbSchema, normalizedModelSchema, normalizedDBSchema, callback);
        });
        return;
      }
      _this11._apply_alter_operations(alterOperations, dbSchema, normalizedModelSchema, normalizedDBSchema, callback);
    });
  }
};

module.exports = TableBuilder;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9idWlsZGVycy90YWJsZS5qcyJdLCJuYW1lcyI6WyJfIiwicmVxdWlyZSIsImFzeW5jIiwidXRpbCIsIm9iamVjdEhhc2giLCJyZWFkbGluZVN5bmMiLCJkZWVwRGlmZiIsImRpZmYiLCJidWlsZEVycm9yIiwic2NoZW1lciIsInBhcnNlciIsIm5vcm1hbGl6ZXIiLCJFbGFzc2FuZHJhQnVpbGRlciIsIlRhYmxlQnVpbGRlciIsImYiLCJkcml2ZXIiLCJwcm9wZXJ0aWVzIiwiX2RyaXZlciIsIl9wcm9wZXJ0aWVzIiwiZXNjbGllbnQiLCJfZXNfYnVpbGRlciIsInByb3RvdHlwZSIsIl9jb25maXJtX21pZ3JhdGlvbiIsIm1lc3NhZ2UiLCJwZXJtaXNzaW9uIiwiZGlzYWJsZVRUWUNvbmZpcm1hdGlvbiIsInF1ZXN0aW9uIiwiZm9ybWF0IiwidG9Mb3dlckNhc2UiLCJnZXRfdGFibGUiLCJjYWxsYmFjayIsImtleXNwYWNlTmFtZSIsImtleXNwYWNlIiwidGFibGVOYW1lIiwidGFibGVfbmFtZSIsImRiU2NoZW1hIiwiZmllbGRzIiwidHlwZU1hcHMiLCJzdGF0aWNNYXBzIiwicXVlcnkiLCJleGVjdXRlX3F1ZXJ5IiwiZXJyIiwicmVzdWx0Q29sdW1ucyIsInJvd3MiLCJsZW5ndGgiLCJyIiwicm93IiwiY29sdW1uX25hbWUiLCJleHRyYWN0X3R5cGUiLCJ0eXBlIiwidHlwZU1hcERlZiIsImV4dHJhY3RfdHlwZURlZiIsImtpbmQiLCJrZXkiLCJwb3NpdGlvbiIsImNsdXN0ZXJpbmdfb3JkZXIiLCJnZXRfdGFibGVfc2NoZW1hIiwiZ2V0X2luZGV4ZXMiLCJlcnIxIiwiaW5kZXhTY2hlbWEiLCJnZXRfbXZpZXdzIiwiZXJyMiIsInZpZXdTY2hlbWEiLCJPYmplY3QiLCJhc3NpZ24iLCJjcmVhdGVfdGFibGUiLCJzY2hlbWEiLCJmaWVsZFR5cGUiLCJrZXlzIiwiZm9yRWFjaCIsImsiLCJ2aXJ0dWFsIiwic2VnbWVudCIsImdldF9maWVsZF90eXBlIiwidHlwZURlZiIsInN0YXRpYyIsInB1c2giLCJjbGF1c2VzIiwiZ2V0X3ByaW1hcnlfa2V5X2NsYXVzZXMiLCJqb2luIiwicGFydGl0aW9uS2V5Q2xhdXNlIiwiY2x1c3RlcmluZ0tleUNsYXVzZSIsImNsdXN0ZXJpbmdPcmRlckNsYXVzZSIsImV4ZWN1dGVfZGVmaW5pdGlvbl9xdWVyeSIsInJlc3VsdCIsImFsdGVyX3RhYmxlIiwib3BlcmF0aW9uIiwiZmllbGRuYW1lIiwiX2Ryb3BfdGFibGUiLCJkcm9wX3RhYmxlIiwibWF0ZXJpYWxpemVkVmlld3MiLCJtdmlld3MiLCJkcm9wX212aWV3cyIsImRyb3BfcmVjcmVhdGVfdGFibGUiLCJtb2RlbFNjaGVtYSIsImRlbGV0ZV9pbmRleCIsInJlc3VsdEluZGV4ZXMiLCJpbmRleF9uYW1lIiwib3B0aW9ucyIsInRhcmdldCIsImluZGV4T3B0aW9ucyIsInJlcGxhY2UiLCJpbmRleF9uYW1lcyIsInVzaW5nIiwiY2xhc3NfbmFtZSIsImN1c3RvbV9pbmRleGVzIiwiY3VzdG9tSW5kZXhPYmplY3QiLCJvbiIsImluZGV4ZXMiLCJfY3JlYXRlX2luZGV4X3F1ZXJ5IiwiaW5kZXhOYW1lIiwiaW5kZXhFeHByZXNzaW9uIiwic3BsaXQiLCJjcmVhdGVfaW5kZXhlcyIsImVhY2hTZXJpZXMiLCJpZHgiLCJuZXh0IiwiX2NyZWF0ZV9jdXN0b21faW5kZXhfcXVlcnkiLCJjdXN0b21JbmRleCIsInNsaWNlIiwiY3JlYXRlX2N1c3RvbV9pbmRleGVzIiwiY3VzdG9tSW5kZXhlcyIsImRyb3BfaW5kZXhlcyIsImVhY2giLCJyZXN1bHRWaWV3cyIsInZpZXdfbmFtZSIsIm1hdGVyaWFsaXplZF92aWV3cyIsIndoZXJlX2NsYXVzZSIsInZpZXdOYW1lcyIsInJlc3VsdE1hdFZpZXdzIiwic2VsZWN0IiwiX2NyZWF0ZV9tYXRlcmlhbGl6ZWRfdmlld19xdWVyeSIsInZpZXdOYW1lIiwid2hlcmVDbGF1c2UiLCJnZXRfbXZpZXdfd2hlcmVfY2xhdXNlIiwiY3JlYXRlX212aWV3cyIsInZpZXciLCJfYXBwbHlfYWx0ZXJfb3BlcmF0aW9ucyIsImFsdGVyT3BlcmF0aW9ucyIsIm5vcm1hbGl6ZWRNb2RlbFNjaGVtYSIsIm5vcm1hbGl6ZWREQlNjaGVtYSIsImFkZGVkSW5kZXhlcyIsImRpZmZlcmVuY2UiLCJyZW1vdmVkSW5kZXhlcyIsInJlbW92ZWRJbmRleE5hbWVzIiwicmVtb3ZlZEluZGV4IiwiYWRkZWRDdXN0b21JbmRleGVzIiwiZmlsdGVyIiwib2JqIiwiZmluZCIsInJlbW92ZWRDdXN0b21JbmRleGVzIiwiYWRkZWRNYXRlcmlhbGl6ZWRWaWV3c05hbWVzIiwiaXNFcXVhbCIsInJlbW92ZWRNYXRlcmlhbGl6ZWRWaWV3TmFtZXMiLCJhZGRlZE1hdGVyaWFsaXplZFZpZXdzIiwiZXJyMyIsImFsdGVyT3BlcmF0aW9uIiwiZmllbGROYW1lIiwiZXJyNCIsImVycjUiLCJlcnI2IiwiaW5pdF9hbHRlcl9vcGVyYXRpb25zIiwiZGlmZmVyZW5jZXMiLCJkcm9wcGVkRmllbGRzIiwicGF0aCIsImV4dHJhY3RfYWx0ZXJlZF90eXBlIiwicmVtb3ZlX2RlcGVuZGVudF92aWV3c19mcm9tX25vcm1hbGl6ZWRfc2NoZW1hIiwiaW5jbHVkZXMiLCJpbmRleE9mIiwiRXJyb3IiLCJsaHMiLCJyaHMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLElBQUlDLFFBQVEsUUFBUixDQUFWO0FBQ0EsSUFBTUMsUUFBUUQsUUFBUSxPQUFSLENBQWQ7QUFDQSxJQUFNRSxPQUFPRixRQUFRLE1BQVIsQ0FBYjtBQUNBLElBQU1HLGFBQWFILFFBQVEsYUFBUixDQUFuQjtBQUNBLElBQU1JLGVBQWVKLFFBQVEsZUFBUixDQUFyQjtBQUNBLElBQU1LLFdBQVdMLFFBQVEsV0FBUixFQUFxQk0sSUFBdEM7O0FBRUEsSUFBTUMsYUFBYVAsUUFBUSx3QkFBUixDQUFuQjtBQUNBLElBQU1RLFVBQVVSLFFBQVEsc0JBQVIsQ0FBaEI7QUFDQSxJQUFNUyxT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Q0FBNkJDLGVBQTdCLEVBQThDdkcsUUFBOUMsRUFBd0R3RyxxQkFBeEQsRUFBK0VDLGtCQUEvRSxFQUFtRzlHLFFBQW5HO0FBQ0QsU0FGRDtBQUdBO0FBQ0Q7QUFDRCxjQUFLMkcsdUJBQUwsQ0FBNkJDLGVBQTdCLEVBQThDdkcsUUFBOUMsRUFBd0R3RyxxQkFBeEQsRUFBK0VDLGtCQUEvRSxFQUFtRzlHLFFBQW5HO0FBQ0QsS0E5SUQ7QUErSUQ7QUF2dEJzQixDQUF6Qjs7QUEwdEJBOEksT0FBT0MsT0FBUCxHQUFpQmhLLFlBQWpCIiwiZmlsZSI6InRhYmxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xuY29uc3QgYXN5bmMgPSByZXF1aXJlKCdhc3luYycpO1xuY29uc3QgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTtcbmNvbnN0IG9iamVjdEhhc2ggPSByZXF1aXJlKCdvYmplY3QtaGFzaCcpO1xuY29uc3QgcmVhZGxpbmVTeW5jID0gcmVxdWlyZSgncmVhZGxpbmUtc3luYycpO1xuY29uc3QgZGVlcERpZmYgPSByZXF1aXJlKCdkZWVwLWRpZmYnKS5kaWZmO1xuXG5jb25zdCBidWlsZEVycm9yID0gcmVxdWlyZSgnLi4vb3JtL2Fwb2xsb19lcnJvci5qcycpO1xuY29uc3Qgc2NoZW1lciA9IHJlcXVpcmUoJy4uL3ZhbGlkYXRvcnMvc2NoZW1hJyk7XG5jb25zdCBwYXJzZXIgPSByZXF1aXJlKCcuLi91dGlscy9wYXJzZXInKTtcbmNvbnN0IG5vcm1hbGl6ZXIgPSByZXF1aXJlKCcuLi91dGlscy9ub3JtYWxpemVyJyk7XG5cbmNvbnN0IEVsYXNzYW5kcmFCdWlsZGVyID0gcmVxdWlyZSgnLi9lbGFzc2FuZHJhJyk7XG5cbmNvbnN0IFRhYmxlQnVpbGRlciA9IGZ1bmN0aW9uIGYoZHJpdmVyLCBwcm9wZXJ0aWVzKSB7XG4gIHRoaXMuX2RyaXZlciA9IGRyaXZlcjtcbiAgdGhpcy5fcHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gIGlmICh0aGlzLl9wcm9wZXJ0aWVzLmVzY2xpZW50KSB7XG4gICAgdGhpcy5fZXNfYnVpbGRlciA9IG5ldyBFbGFzc2FuZHJhQnVpbGRlcih0aGlzLl9wcm9wZXJ0aWVzLmVzY2xpZW50KTtcbiAgfVxufTtcblxuVGFibGVCdWlsZGVyLnByb3RvdHlwZSA9IHtcbiAgX2NvbmZpcm1fbWlncmF0aW9uKG1lc3NhZ2UpIHtcbiAgICBsZXQgcGVybWlzc2lvbiA9ICd5JztcbiAgICBpZiAobWVzc2FnZSAmJiAhdGhpcy5fcHJvcGVydGllcy5kaXNhYmxlVFRZQ29uZmlybWF0aW9uKSB7XG4gICAgICBwZXJtaXNzaW9uID0gcmVhZGxpbmVTeW5jLnF1ZXN0aW9uKHV0aWwuZm9ybWF0KCdNaWdyYXRpb246ICVzICh5L24pOiAnLCBtZXNzYWdlKSk7XG4gICAgfVxuICAgIHJldHVybiBwZXJtaXNzaW9uLnRvTG93ZXJDYXNlKCk7XG4gIH0sXG4gIGdldF90YWJsZShjYWxsYmFjaykge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzO1xuICAgIGNvbnN0IGtleXNwYWNlTmFtZSA9IHByb3BlcnRpZXMua2V5c3BhY2U7XG4gICAgY29uc3QgdGFibGVOYW1lID0gcHJvcGVydGllcy50YWJsZV9uYW1lO1xuICAgIGNvbnN0IGRiU2NoZW1hID0geyBmaWVsZHM6IHt9LCB0eXBlTWFwczoge30sIHN0YXRpY01hcHM6IHt9IH07XG4gICAgY29uc3QgcXVlcnkgPSAnU0VMRUNUICogRlJPTSBzeXN0ZW1fc2NoZW1hLmNvbHVtbnMgV0hFUkUgdGFibGVfbmFtZSA9ID8gQU5EIGtleXNwYWNlX25hbWUgPSA/Oyc7XG5cbiAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9xdWVyeShxdWVyeSwgW3RhYmxlTmFtZSwga2V5c3BhY2VOYW1lXSwgKGVyciwgcmVzdWx0Q29sdW1ucykgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBjYWxsYmFjayhidWlsZEVycm9yKCdtb2RlbC50YWJsZWNyZWF0aW9uLmRic2NoZW1hcXVlcnknLCBlcnIpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXJlc3VsdENvbHVtbnMucm93cyB8fCByZXN1bHRDb2x1bW5zLnJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByZXN1bHRDb2x1bW5zLnJvd3MubGVuZ3RoOyByKyspIHtcbiAgICAgICAgY29uc3Qgcm93ID0gcmVzdWx0Q29sdW1ucy5yb3dzW3JdO1xuXG4gICAgICAgIGRiU2NoZW1hLmZpZWxkc1tyb3cuY29sdW1uX25hbWVdID0gcGFyc2VyLmV4dHJhY3RfdHlwZShyb3cudHlwZSk7XG5cbiAgICAgICAgY29uc3QgdHlwZU1hcERlZiA9IHBhcnNlci5leHRyYWN0X3R5cGVEZWYocm93LnR5cGUpO1xuICAgICAgICBpZiAodHlwZU1hcERlZi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZGJTY2hlbWEudHlwZU1hcHNbcm93LmNvbHVtbl9uYW1lXSA9IHR5cGVNYXBEZWY7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocm93LmtpbmQgPT09ICdwYXJ0aXRpb25fa2V5Jykge1xuICAgICAgICAgIGlmICghZGJTY2hlbWEua2V5KSBkYlNjaGVtYS5rZXkgPSBbW11dO1xuICAgICAgICAgIGRiU2NoZW1hLmtleVswXVtyb3cucG9zaXRpb25dID0gcm93LmNvbHVtbl9uYW1lO1xuICAgICAgICB9IGVsc2UgaWYgKHJvdy5raW5kID09PSAnY2x1c3RlcmluZycpIHtcbiAgICAgICAgICBpZiAoIWRiU2NoZW1hLmtleSkgZGJTY2hlbWEua2V5ID0gW1tdXTtcbiAgICAgICAgICBpZiAoIWRiU2NoZW1hLmNsdXN0ZXJpbmdfb3JkZXIpIGRiU2NoZW1hLmNsdXN0ZXJpbmdfb3JkZXIgPSB7fTtcblxuICAgICAgICAgIGRiU2NoZW1hLmtleVtyb3cucG9zaXRpb24gKyAxXSA9IHJvdy5jb2x1bW5fbmFtZTtcbiAgICAgICAgICBpZiAocm93LmNsdXN0ZXJpbmdfb3JkZXIgJiYgcm93LmNsdXN0ZXJpbmdfb3JkZXIudG9Mb3dlckNhc2UoKSA9PT0gJ2Rlc2MnKSB7XG4gICAgICAgICAgICBkYlNjaGVtYS5jbHVzdGVyaW5nX29yZGVyW3Jvdy5jb2x1bW5fbmFtZV0gPSAnREVTQyc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRiU2NoZW1hLmNsdXN0ZXJpbmdfb3JkZXJbcm93LmNvbHVtbl9uYW1lXSA9ICdBU0MnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyb3cua2luZCA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgICBkYlNjaGVtYS5zdGF0aWNNYXBzW3Jvdy5jb2x1bW5fbmFtZV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNhbGxiYWNrKG51bGwsIGRiU2NoZW1hKTtcbiAgICB9KTtcbiAgfSxcblxuICBnZXRfdGFibGVfc2NoZW1hKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5nZXRfdGFibGUoKGVyciwgZGJTY2hlbWEpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCFkYlNjaGVtYSkge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmdldF9pbmRleGVzKChlcnIxLCBpbmRleFNjaGVtYSkgPT4ge1xuICAgICAgICBpZiAoZXJyMSkge1xuICAgICAgICAgIGNhbGxiYWNrKGVycjEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmdldF9tdmlld3MoKGVycjIsIHZpZXdTY2hlbWEpID0+IHtcbiAgICAgICAgICBpZiAoZXJyMikge1xuICAgICAgICAgICAgY2FsbGJhY2soZXJyMik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGJTY2hlbWEsIGluZGV4U2NoZW1hLCB2aWV3U2NoZW1hKTtcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYlNjaGVtYSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgY3JlYXRlX3RhYmxlKHNjaGVtYSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllcztcbiAgICBjb25zdCB0YWJsZU5hbWUgPSBwcm9wZXJ0aWVzLnRhYmxlX25hbWU7XG4gICAgY29uc3Qgcm93cyA9IFtdO1xuICAgIGxldCBmaWVsZFR5cGU7XG4gICAgT2JqZWN0LmtleXMoc2NoZW1hLmZpZWxkcykuZm9yRWFjaCgoaykgPT4ge1xuICAgICAgaWYgKHNjaGVtYS5maWVsZHNba10udmlydHVhbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsZXQgc2VnbWVudCA9ICcnO1xuICAgICAgZmllbGRUeXBlID0gc2NoZW1lci5nZXRfZmllbGRfdHlwZShzY2hlbWEsIGspO1xuICAgICAgaWYgKHNjaGVtYS5maWVsZHNba10udHlwZURlZikge1xuICAgICAgICBzZWdtZW50ID0gdXRpbC5mb3JtYXQoJ1wiJXNcIiAlcyVzJywgaywgZmllbGRUeXBlLCBzY2hlbWEuZmllbGRzW2tdLnR5cGVEZWYpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VnbWVudCA9IHV0aWwuZm9ybWF0KCdcIiVzXCIgJXMnLCBrLCBmaWVsZFR5cGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2NoZW1hLmZpZWxkc1trXS5zdGF0aWMpIHtcbiAgICAgICAgc2VnbWVudCArPSAnIFNUQVRJQyc7XG4gICAgICB9XG5cbiAgICAgIHJvd3MucHVzaChzZWdtZW50KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGNsYXVzZXMgPSBwYXJzZXIuZ2V0X3ByaW1hcnlfa2V5X2NsYXVzZXMoc2NoZW1hKTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoXG4gICAgICAnQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgXCIlc1wiICglcyAsIFBSSU1BUlkgS0VZKCglcyklcykpJXM7JyxcbiAgICAgIHRhYmxlTmFtZSxcbiAgICAgIHJvd3Muam9pbignICwgJyksXG4gICAgICBjbGF1c2VzLnBhcnRpdGlvbktleUNsYXVzZSxcbiAgICAgIGNsYXVzZXMuY2x1c3RlcmluZ0tleUNsYXVzZSxcbiAgICAgIGNsYXVzZXMuY2x1c3RlcmluZ09yZGVyQ2xhdXNlLFxuICAgICk7XG5cbiAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9kZWZpbml0aW9uX3F1ZXJ5KHF1ZXJ5LCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYmNyZWF0ZScsIGVycikpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjYWxsYmFjayhudWxsLCByZXN1bHQpO1xuICAgIH0pO1xuICB9LFxuXG4gIGFsdGVyX3RhYmxlKG9wZXJhdGlvbiwgZmllbGRuYW1lLCB0eXBlLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzO1xuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHByb3BlcnRpZXMudGFibGVfbmFtZTtcbiAgICBpZiAob3BlcmF0aW9uID09PSAnQUxURVInKSB0eXBlID0gdXRpbC5mb3JtYXQoJ1RZUEUgJXMnLCB0eXBlKTtcbiAgICBlbHNlIGlmIChvcGVyYXRpb24gPT09ICdEUk9QJykgdHlwZSA9ICcnO1xuXG4gICAgY29uc3QgcXVlcnkgPSB1dGlsLmZvcm1hdCgnQUxURVIgVEFCTEUgXCIlc1wiICVzIFwiJXNcIiAlczsnLCB0YWJsZU5hbWUsIG9wZXJhdGlvbiwgZmllbGRuYW1lLCB0eXBlKTtcbiAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9kZWZpbml0aW9uX3F1ZXJ5KHF1ZXJ5LCBjYWxsYmFjayk7XG4gIH0sXG5cbiAgX2Ryb3BfdGFibGUodGFibGVOYW1lLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoJ0RST1AgVEFCTEUgSUYgRVhJU1RTIFwiJXNcIjsnLCB0YWJsZU5hbWUpO1xuICAgIHRoaXMuX2RyaXZlci5leGVjdXRlX2RlZmluaXRpb25fcXVlcnkocXVlcnksIChlcnIpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYmRyb3AnLCBlcnIpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfSxcblxuICBkcm9wX3RhYmxlKG1hdGVyaWFsaXplZFZpZXdzLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzO1xuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHByb3BlcnRpZXMudGFibGVfbmFtZTtcbiAgICBjb25zdCBtZXNzYWdlID0gdXRpbC5mb3JtYXQoXG4gICAgICAnU2NoZW1hIGZvciB0YWJsZSBcIiVzXCIgaGFzIGNoYW5nZWQgaW4gYSB3YXkgd2hlcmUgYWx0ZXIgbWlncmF0aW9uIGlzIG5vdCBwb3NzaWJsZSwgYWxsIGRhdGEgaW4gdGhlIHRhYmxlIHdpbGwgYmUgbG9zdCwgYXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRyb3AgdGhlIHRhYmxlPycsXG4gICAgICB0YWJsZU5hbWUsXG4gICAgKTtcbiAgICBjb25zdCBwZXJtaXNzaW9uID0gdGhpcy5fY29uZmlybV9taWdyYXRpb24obWVzc2FnZSk7XG4gICAgaWYgKHBlcm1pc3Npb24gIT09ICd5Jykge1xuICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5zY2hlbWFtaXNtYXRjaCcsIHRhYmxlTmFtZSwgJ21pZ3JhdGlvbiBzdXNwZW5kZWQsIHBsZWFzZSBhcHBseSB0aGUgY2hhbmdlIG1hbnVhbGx5JykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIW1hdGVyaWFsaXplZFZpZXdzKSB7XG4gICAgICB0aGlzLl9kcm9wX3RhYmxlKHRhYmxlTmFtZSwgY2FsbGJhY2spO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG12aWV3cyA9IE9iamVjdC5rZXlzKG1hdGVyaWFsaXplZFZpZXdzKTtcbiAgICB0aGlzLmRyb3BfbXZpZXdzKG12aWV3cywgKGVycikgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2Ryb3BfdGFibGUodGFibGVOYW1lLCBjYWxsYmFjayk7XG4gICAgfSk7XG4gIH0sXG5cbiAgZHJvcF9yZWNyZWF0ZV90YWJsZShtb2RlbFNjaGVtYSwgbWF0ZXJpYWxpemVkVmlld3MsIGNhbGxiYWNrKSB7XG4gICAgaWYgKHRoaXMuX2VzX2J1aWxkZXIpIHtcbiAgICAgIHRoaXMuX2VzX2J1aWxkZXIuZGVsZXRlX2luZGV4KHRoaXMuX3Byb3BlcnRpZXMua2V5c3BhY2UsICgpID0+IHtcbiAgICAgICAgdGhpcy5kcm9wX3RhYmxlKG1hdGVyaWFsaXplZFZpZXdzLCAoZXJyMSkgPT4ge1xuICAgICAgICAgIGlmIChlcnIxKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhlcnIxKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jcmVhdGVfdGFibGUobW9kZWxTY2hlbWEsIGNhbGxiYWNrKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5kcm9wX3RhYmxlKG1hdGVyaWFsaXplZFZpZXdzLCAoZXJyMSkgPT4ge1xuICAgICAgaWYgKGVycjEpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyMSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuY3JlYXRlX3RhYmxlKG1vZGVsU2NoZW1hLCBjYWxsYmFjayk7XG4gICAgfSk7XG4gIH0sXG5cbiAgZ2V0X2luZGV4ZXMoY2FsbGJhY2spIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllcztcbiAgICBjb25zdCBrZXlzcGFjZU5hbWUgPSBwcm9wZXJ0aWVzLmtleXNwYWNlO1xuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHByb3BlcnRpZXMudGFibGVfbmFtZTtcbiAgICBjb25zdCBkYlNjaGVtYSA9IHt9O1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gc3lzdGVtX3NjaGVtYS5pbmRleGVzIFdIRVJFIHRhYmxlX25hbWUgPSA/IEFORCBrZXlzcGFjZV9uYW1lID0gPzsnO1xuXG4gICAgdGhpcy5fZHJpdmVyLmV4ZWN1dGVfcXVlcnkocXVlcnksIFt0YWJsZU5hbWUsIGtleXNwYWNlTmFtZV0sIChlcnIsIHJlc3VsdEluZGV4ZXMpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYnNjaGVtYXF1ZXJ5JywgZXJyKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByZXN1bHRJbmRleGVzLnJvd3MubGVuZ3RoOyByKyspIHtcbiAgICAgICAgY29uc3Qgcm93ID0gcmVzdWx0SW5kZXhlcy5yb3dzW3JdO1xuXG4gICAgICAgIGlmIChyb3cuaW5kZXhfbmFtZSAmJiByb3cub3B0aW9ucy50YXJnZXQpIHtcbiAgICAgICAgICBjb25zdCBpbmRleE9wdGlvbnMgPSByb3cub3B0aW9ucztcbiAgICAgICAgICBsZXQgdGFyZ2V0ID0gaW5kZXhPcHRpb25zLnRhcmdldDtcbiAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucmVwbGFjZSgvW1wiXFxzXS9nLCAnJyk7XG4gICAgICAgICAgZGVsZXRlIGluZGV4T3B0aW9ucy50YXJnZXQ7XG5cbiAgICAgICAgICAvLyBrZWVwaW5nIHRyYWNrIG9mIGluZGV4IG5hbWVzIHRvIGRyb3AgaW5kZXggd2hlbiBuZWVkZWRcbiAgICAgICAgICBpZiAoIWRiU2NoZW1hLmluZGV4X25hbWVzKSBkYlNjaGVtYS5pbmRleF9uYW1lcyA9IHt9O1xuXG4gICAgICAgICAgaWYgKHJvdy5raW5kID09PSAnQ1VTVE9NJykge1xuICAgICAgICAgICAgY29uc3QgdXNpbmcgPSBpbmRleE9wdGlvbnMuY2xhc3NfbmFtZTtcbiAgICAgICAgICAgIGRlbGV0ZSBpbmRleE9wdGlvbnMuY2xhc3NfbmFtZTtcblxuICAgICAgICAgICAgaWYgKCFkYlNjaGVtYS5jdXN0b21faW5kZXhlcykgZGJTY2hlbWEuY3VzdG9tX2luZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbUluZGV4T2JqZWN0ID0ge1xuICAgICAgICAgICAgICBvbjogdGFyZ2V0LFxuICAgICAgICAgICAgICB1c2luZyxcbiAgICAgICAgICAgICAgb3B0aW9uczogaW5kZXhPcHRpb25zLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGRiU2NoZW1hLmN1c3RvbV9pbmRleGVzLnB1c2goY3VzdG9tSW5kZXhPYmplY3QpO1xuICAgICAgICAgICAgZGJTY2hlbWEuaW5kZXhfbmFtZXNbb2JqZWN0SGFzaChjdXN0b21JbmRleE9iamVjdCldID0gcm93LmluZGV4X25hbWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZGJTY2hlbWEuaW5kZXhlcykgZGJTY2hlbWEuaW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgZGJTY2hlbWEuaW5kZXhlcy5wdXNoKHRhcmdldCk7XG4gICAgICAgICAgICBkYlNjaGVtYS5pbmRleF9uYW1lc1t0YXJnZXRdID0gcm93LmluZGV4X25hbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNhbGxiYWNrKG51bGwsIGRiU2NoZW1hKTtcbiAgICB9KTtcbiAgfSxcblxuICBfY3JlYXRlX2luZGV4X3F1ZXJ5KHRhYmxlTmFtZSwgaW5kZXhOYW1lKSB7XG4gICAgbGV0IHF1ZXJ5O1xuICAgIGNvbnN0IGluZGV4RXhwcmVzc2lvbiA9IGluZGV4TmFtZS5yZXBsYWNlKC9bXCJcXHNdL2csICcnKS5zcGxpdCgvWygpXS9nKTtcbiAgICBpZiAoaW5kZXhFeHByZXNzaW9uLmxlbmd0aCA+IDEpIHtcbiAgICAgIGluZGV4RXhwcmVzc2lvblswXSA9IGluZGV4RXhwcmVzc2lvblswXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgcXVlcnkgPSB1dGlsLmZvcm1hdChcbiAgICAgICAgJ0NSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIE9OIFwiJXNcIiAoJXMoXCIlc1wiKSk7JyxcbiAgICAgICAgdGFibGVOYW1lLFxuICAgICAgICBpbmRleEV4cHJlc3Npb25bMF0sXG4gICAgICAgIGluZGV4RXhwcmVzc2lvblsxXSxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHF1ZXJ5ID0gdXRpbC5mb3JtYXQoXG4gICAgICAgICdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBPTiBcIiVzXCIgKFwiJXNcIik7JyxcbiAgICAgICAgdGFibGVOYW1lLFxuICAgICAgICBpbmRleEV4cHJlc3Npb25bMF0sXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gcXVlcnk7XG4gIH0sXG5cbiAgY3JlYXRlX2luZGV4ZXMoaW5kZXhlcywgY2FsbGJhY2spIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllcztcbiAgICBjb25zdCB0YWJsZU5hbWUgPSBwcm9wZXJ0aWVzLnRhYmxlX25hbWU7XG4gICAgYXN5bmMuZWFjaFNlcmllcyhpbmRleGVzLCAoaWR4LCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBxdWVyeSA9IHRoaXMuX2NyZWF0ZV9pbmRleF9xdWVyeSh0YWJsZU5hbWUsIGlkeCk7XG4gICAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9kZWZpbml0aW9uX3F1ZXJ5KHF1ZXJ5LCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKGVycikgbmV4dChidWlsZEVycm9yKCdtb2RlbC50YWJsZWNyZWF0aW9uLmRiaW5kZXhjcmVhdGUnLCBlcnIpKTtcbiAgICAgICAgZWxzZSBuZXh0KG51bGwsIHJlc3VsdCk7XG4gICAgICB9KTtcbiAgICB9LCBjYWxsYmFjayk7XG4gIH0sXG5cbiAgX2NyZWF0ZV9jdXN0b21faW5kZXhfcXVlcnkodGFibGVOYW1lLCBjdXN0b21JbmRleCkge1xuICAgIGxldCBxdWVyeSA9IHV0aWwuZm9ybWF0KFxuICAgICAgJ0NSRUFURSBDVVNUT00gSU5ERVggSUYgTk9UIEVYSVNUUyBPTiBcIiVzXCIgKFwiJXNcIikgVVNJTkcgXFwnJXNcXCcnLFxuICAgICAgdGFibGVOYW1lLFxuICAgICAgY3VzdG9tSW5kZXgub24sXG4gICAgICBjdXN0b21JbmRleC51c2luZyxcbiAgICApO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGN1c3RvbUluZGV4Lm9wdGlvbnMpLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ICs9ICcgV0lUSCBPUFRJT05TID0geyc7XG4gICAgICBPYmplY3Qua2V5cyhjdXN0b21JbmRleC5vcHRpb25zKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgcXVlcnkgKz0gdXRpbC5mb3JtYXQoXCInJXMnOiAnJXMnLCBcIiwga2V5LCBjdXN0b21JbmRleC5vcHRpb25zW2tleV0pO1xuICAgICAgfSk7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LnNsaWNlKDAsIC0yKTtcbiAgICAgIHF1ZXJ5ICs9ICd9JztcbiAgICB9XG5cbiAgICBxdWVyeSArPSAnOyc7XG5cbiAgICByZXR1cm4gcXVlcnk7XG4gIH0sXG5cbiAgY3JlYXRlX2N1c3RvbV9pbmRleGVzKGN1c3RvbUluZGV4ZXMsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IHRoaXMuX3Byb3BlcnRpZXM7XG4gICAgY29uc3QgdGFibGVOYW1lID0gcHJvcGVydGllcy50YWJsZV9uYW1lO1xuICAgIGFzeW5jLmVhY2hTZXJpZXMoY3VzdG9tSW5kZXhlcywgKGlkeCwgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSB0aGlzLl9jcmVhdGVfY3VzdG9tX2luZGV4X3F1ZXJ5KHRhYmxlTmFtZSwgaWR4KTtcbiAgICAgIHRoaXMuX2RyaXZlci5leGVjdXRlX2RlZmluaXRpb25fcXVlcnkocXVlcnksIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgICBpZiAoZXJyKSBuZXh0KGJ1aWxkRXJyb3IoJ21vZGVsLnRhYmxlY3JlYXRpb24uZGJpbmRleGNyZWF0ZScsIGVycikpO1xuICAgICAgICBlbHNlIG5leHQobnVsbCwgcmVzdWx0KTtcbiAgICAgIH0pO1xuICAgIH0sIGNhbGxiYWNrKTtcbiAgfSxcblxuICBkcm9wX2luZGV4ZXMoaW5kZXhlcywgY2FsbGJhY2spIHtcbiAgICBhc3luYy5lYWNoKGluZGV4ZXMsIChpZHgsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoJ0RST1AgSU5ERVggSUYgRVhJU1RTIFwiJXNcIjsnLCBpZHgpO1xuICAgICAgdGhpcy5fZHJpdmVyLmV4ZWN1dGVfZGVmaW5pdGlvbl9xdWVyeShxdWVyeSwgbmV4dCk7XG4gICAgfSwgKGVycikgPT4ge1xuICAgICAgaWYgKGVycikgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYmluZGV4ZHJvcCcsIGVycikpO1xuICAgICAgZWxzZSBjYWxsYmFjaygpO1xuICAgIH0pO1xuICB9LFxuXG4gIGdldF9tdmlld3MoY2FsbGJhY2spIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllcztcbiAgICBjb25zdCBrZXlzcGFjZU5hbWUgPSBwcm9wZXJ0aWVzLmtleXNwYWNlO1xuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHByb3BlcnRpZXMudGFibGVfbmFtZTtcbiAgICBjb25zdCBkYlNjaGVtYSA9IHt9O1xuICAgIGxldCBxdWVyeSA9ICdTRUxFQ1Qgdmlld19uYW1lLGJhc2VfdGFibGVfbmFtZSx3aGVyZV9jbGF1c2UgRlJPTSBzeXN0ZW1fc2NoZW1hLnZpZXdzIFdIRVJFIGtleXNwYWNlX25hbWU9PyBBTkQgYmFzZV90YWJsZV9uYW1lPT8gQUxMT1cgRklMVEVSSU5HOyc7XG5cbiAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9xdWVyeShxdWVyeSwgW2tleXNwYWNlTmFtZSwgdGFibGVOYW1lXSwgKGVyciwgcmVzdWx0Vmlld3MpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYnNjaGVtYXF1ZXJ5JywgZXJyKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCByZXN1bHRWaWV3cy5yb3dzLmxlbmd0aDsgcisrKSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IHJlc3VsdFZpZXdzLnJvd3Nbcl07XG5cbiAgICAgICAgaWYgKHJvdy52aWV3X25hbWUpIHtcbiAgICAgICAgICBpZiAoIWRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3cykgZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzID0ge307XG4gICAgICAgICAgZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzW3Jvdy52aWV3X25hbWVdID0ge1xuICAgICAgICAgICAgd2hlcmVfY2xhdXNlOiByb3cud2hlcmVfY2xhdXNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFkYlNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3MpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZGJTY2hlbWEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gc3lzdGVtX3NjaGVtYS5jb2x1bW5zIFdIRVJFIGtleXNwYWNlX25hbWU9PyBhbmQgdGFibGVfbmFtZSBJTiA/Oyc7XG5cbiAgICAgIGNvbnN0IHZpZXdOYW1lcyA9IE9iamVjdC5rZXlzKGRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3cyk7XG4gICAgICB0aGlzLl9kcml2ZXIuZXhlY3V0ZV9xdWVyeShxdWVyeSwgW2tleXNwYWNlTmFtZSwgdmlld05hbWVzXSwgKGVycjEsIHJlc3VsdE1hdFZpZXdzKSA9PiB7XG4gICAgICAgIGlmIChlcnIxKSB7XG4gICAgICAgICAgY2FsbGJhY2soYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5kYnNjaGVtYXF1ZXJ5JywgZXJyMSkpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgcmVzdWx0TWF0Vmlld3Mucm93cy5sZW5ndGg7IHIrKykge1xuICAgICAgICAgIGNvbnN0IHJvdyA9IHJlc3VsdE1hdFZpZXdzLnJvd3Nbcl07XG5cbiAgICAgICAgICBpZiAoIWRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0uc2VsZWN0KSB7XG4gICAgICAgICAgICBkYlNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3Nbcm93LnRhYmxlX25hbWVdLnNlbGVjdCA9IFtdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0uc2VsZWN0LnB1c2gocm93LmNvbHVtbl9uYW1lKTtcblxuICAgICAgICAgIGlmIChyb3cua2luZCA9PT0gJ3BhcnRpdGlvbl9rZXknKSB7XG4gICAgICAgICAgICBpZiAoIWRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0ua2V5KSB7XG4gICAgICAgICAgICAgIGRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0ua2V5ID0gW1tdXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzW3Jvdy50YWJsZV9uYW1lXS5rZXlbMF1bcm93LnBvc2l0aW9uXSA9IHJvdy5jb2x1bW5fbmFtZTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHJvdy5raW5kID09PSAnY2x1c3RlcmluZycpIHtcbiAgICAgICAgICAgIGlmICghZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzW3Jvdy50YWJsZV9uYW1lXS5rZXkpIHtcbiAgICAgICAgICAgICAgZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzW3Jvdy50YWJsZV9uYW1lXS5rZXkgPSBbW11dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkYlNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3Nbcm93LnRhYmxlX25hbWVdLmNsdXN0ZXJpbmdfb3JkZXIpIHtcbiAgICAgICAgICAgICAgZGJTY2hlbWEubWF0ZXJpYWxpemVkX3ZpZXdzW3Jvdy50YWJsZV9uYW1lXS5jbHVzdGVyaW5nX29yZGVyID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0ua2V5W3Jvdy5wb3NpdGlvbiArIDFdID0gcm93LmNvbHVtbl9uYW1lO1xuICAgICAgICAgICAgaWYgKHJvdy5jbHVzdGVyaW5nX29yZGVyICYmIHJvdy5jbHVzdGVyaW5nX29yZGVyLnRvTG93ZXJDYXNlKCkgPT09ICdkZXNjJykge1xuICAgICAgICAgICAgICBkYlNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3Nbcm93LnRhYmxlX25hbWVdLmNsdXN0ZXJpbmdfb3JkZXJbcm93LmNvbHVtbl9uYW1lXSA9ICdERVNDJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGRiU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1tyb3cudGFibGVfbmFtZV0uY2x1c3RlcmluZ19vcmRlcltyb3cuY29sdW1uX25hbWVdID0gJ0FTQyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZGJTY2hlbWEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgX2NyZWF0ZV9tYXRlcmlhbGl6ZWRfdmlld19xdWVyeSh0YWJsZU5hbWUsIHZpZXdOYW1lLCB2aWV3U2NoZW1hKSB7XG4gICAgY29uc3Qgcm93cyA9IFtdO1xuXG4gICAgZm9yIChsZXQgayA9IDA7IGsgPCB2aWV3U2NoZW1hLnNlbGVjdC5sZW5ndGg7IGsrKykge1xuICAgICAgaWYgKHZpZXdTY2hlbWEuc2VsZWN0W2tdID09PSAnKicpIHJvd3MucHVzaCh1dGlsLmZvcm1hdCgnJXMnLCB2aWV3U2NoZW1hLnNlbGVjdFtrXSkpO1xuICAgICAgZWxzZSByb3dzLnB1c2godXRpbC5mb3JtYXQoJ1wiJXNcIicsIHZpZXdTY2hlbWEuc2VsZWN0W2tdKSk7XG4gICAgfVxuXG4gICAgY29uc3Qgd2hlcmVDbGF1c2UgPSB2aWV3U2NoZW1hLndoZXJlX2NsYXVzZSB8fCBwYXJzZXIuZ2V0X212aWV3X3doZXJlX2NsYXVzZSh0aGlzLl9wcm9wZXJ0aWVzLnNjaGVtYSwgdmlld1NjaGVtYSk7XG4gICAgY29uc3QgY2xhdXNlcyA9IHBhcnNlci5nZXRfcHJpbWFyeV9rZXlfY2xhdXNlcyh2aWV3U2NoZW1hKTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoXG4gICAgICAnQ1JFQVRFIE1BVEVSSUFMSVpFRCBWSUVXIElGIE5PVCBFWElTVFMgXCIlc1wiIEFTIFNFTEVDVCAlcyBGUk9NIFwiJXNcIiBXSEVSRSAlcyBQUklNQVJZIEtFWSgoJXMpJXMpJXM7JyxcbiAgICAgIHZpZXdOYW1lLFxuICAgICAgcm93cy5qb2luKCcgLCAnKSxcbiAgICAgIHRhYmxlTmFtZSxcbiAgICAgIHdoZXJlQ2xhdXNlLFxuICAgICAgY2xhdXNlcy5wYXJ0aXRpb25LZXlDbGF1c2UsXG4gICAgICBjbGF1c2VzLmNsdXN0ZXJpbmdLZXlDbGF1c2UsXG4gICAgICBjbGF1c2VzLmNsdXN0ZXJpbmdPcmRlckNsYXVzZSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHF1ZXJ5O1xuICB9LFxuXG4gIGNyZWF0ZV9tdmlld3MobWF0ZXJpYWxpemVkVmlld3MsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IHRoaXMuX3Byb3BlcnRpZXM7XG4gICAgY29uc3QgdGFibGVOYW1lID0gcHJvcGVydGllcy50YWJsZV9uYW1lO1xuICAgIGFzeW5jLmVhY2hTZXJpZXMoT2JqZWN0LmtleXMobWF0ZXJpYWxpemVkVmlld3MpLCAodmlld05hbWUsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5fY3JlYXRlX21hdGVyaWFsaXplZF92aWV3X3F1ZXJ5KFxuICAgICAgICB0YWJsZU5hbWUsXG4gICAgICAgIHZpZXdOYW1lLFxuICAgICAgICBtYXRlcmlhbGl6ZWRWaWV3c1t2aWV3TmFtZV0sXG4gICAgICApO1xuICAgICAgdGhpcy5fZHJpdmVyLmV4ZWN1dGVfZGVmaW5pdGlvbl9xdWVyeShxdWVyeSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICAgIGlmIChlcnIpIG5leHQoYnVpbGRFcnJvcignbW9kZWwudGFibGVjcmVhdGlvbi5tYXR2aWV3Y3JlYXRlJywgZXJyKSk7XG4gICAgICAgIGVsc2UgbmV4dChudWxsLCByZXN1bHQpO1xuICAgICAgfSk7XG4gICAgfSwgY2FsbGJhY2spO1xuICB9LFxuXG4gIGRyb3BfbXZpZXdzKG12aWV3cywgY2FsbGJhY2spIHtcbiAgICBhc3luYy5lYWNoKG12aWV3cywgKHZpZXcsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gdXRpbC5mb3JtYXQoJ0RST1AgTUFURVJJQUxJWkVEIFZJRVcgSUYgRVhJU1RTIFwiJXNcIjsnLCB2aWV3KTtcbiAgICAgIHRoaXMuX2RyaXZlci5leGVjdXRlX2RlZmluaXRpb25fcXVlcnkocXVlcnksIG5leHQpO1xuICAgIH0sIChlcnIpID0+IHtcbiAgICAgIGlmIChlcnIpIGNhbGxiYWNrKGJ1aWxkRXJyb3IoJ21vZGVsLnRhYmxlY3JlYXRpb24ubWF0dmlld2Ryb3AnLCBlcnIpKTtcbiAgICAgIGVsc2UgY2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfSxcblxuICBfYXBwbHlfYWx0ZXJfb3BlcmF0aW9ucyhhbHRlck9wZXJhdGlvbnMsIGRiU2NoZW1hLCBub3JtYWxpemVkTW9kZWxTY2hlbWEsIG5vcm1hbGl6ZWREQlNjaGVtYSwgY2FsbGJhY2spIHtcbiAgICAvLyBpdCBzaG91bGQgY3JlYXRlL2Ryb3AgaW5kZXhlcy9jdXN0b21faW5kZXhlcy9tYXRlcmlhbGl6ZWRfdmlld3MgdGhhdCBhcmUgYWRkZWQvcmVtb3ZlZCBpbiBtb2RlbCBzY2hlbWFcbiAgICAvLyByZW1vdmUgY29tbW9uIGluZGV4ZXMvY3VzdG9tX2luZGV4ZXMvbWF0ZXJpYWxpemVkX3ZpZXdzIGZyb20gbm9ybWFsaXplZE1vZGVsU2NoZW1hIGFuZCBub3JtYWxpemVkREJTY2hlbWFcbiAgICAvLyB0aGVuIGRyb3AgYWxsIHJlbWFpbmluZyBpbmRleGVzL2N1c3RvbV9pbmRleGVzL21hdGVyaWFsaXplZF92aWV3cyBmcm9tIG5vcm1hbGl6ZWREQlNjaGVtYVxuICAgIC8vIGFuZCBhZGQgYWxsIHJlbWFpbmluZyBpbmRleGVzL2N1c3RvbV9pbmRleGVzL21hdGVyaWFsaXplZF92aWV3cyBmcm9tIG5vcm1hbGl6ZWRNb2RlbFNjaGVtYVxuICAgIGNvbnN0IHByb3BlcnRpZXMgPSB0aGlzLl9wcm9wZXJ0aWVzO1xuICAgIGNvbnN0IHRhYmxlTmFtZSA9IHByb3BlcnRpZXMudGFibGVfbmFtZTtcbiAgICBjb25zdCBhZGRlZEluZGV4ZXMgPSBfLmRpZmZlcmVuY2Uobm9ybWFsaXplZE1vZGVsU2NoZW1hLmluZGV4ZXMsIG5vcm1hbGl6ZWREQlNjaGVtYS5pbmRleGVzKTtcbiAgICBjb25zdCByZW1vdmVkSW5kZXhlcyA9IF8uZGlmZmVyZW5jZShub3JtYWxpemVkREJTY2hlbWEuaW5kZXhlcywgbm9ybWFsaXplZE1vZGVsU2NoZW1hLmluZGV4ZXMpO1xuICAgIGNvbnN0IHJlbW92ZWRJbmRleE5hbWVzID0gW107XG4gICAgcmVtb3ZlZEluZGV4ZXMuZm9yRWFjaCgocmVtb3ZlZEluZGV4KSA9PiB7XG4gICAgICByZW1vdmVkSW5kZXhOYW1lcy5wdXNoKGRiU2NoZW1hLmluZGV4X25hbWVzW3JlbW92ZWRJbmRleF0pO1xuICAgIH0pO1xuXG4gICAgY29uc3QgYWRkZWRDdXN0b21JbmRleGVzID0gXy5maWx0ZXIoXG4gICAgICBub3JtYWxpemVkTW9kZWxTY2hlbWEuY3VzdG9tX2luZGV4ZXMsXG4gICAgICAob2JqKSA9PiAoIV8uZmluZChub3JtYWxpemVkREJTY2hlbWEuY3VzdG9tX2luZGV4ZXMsIG9iaikpLFxuICAgICk7XG4gICAgY29uc3QgcmVtb3ZlZEN1c3RvbUluZGV4ZXMgPSBfLmZpbHRlcihcbiAgICAgIG5vcm1hbGl6ZWREQlNjaGVtYS5jdXN0b21faW5kZXhlcyxcbiAgICAgIChvYmopID0+ICghXy5maW5kKG5vcm1hbGl6ZWRNb2RlbFNjaGVtYS5jdXN0b21faW5kZXhlcywgb2JqKSksXG4gICAgKTtcbiAgICByZW1vdmVkQ3VzdG9tSW5kZXhlcy5mb3JFYWNoKChyZW1vdmVkSW5kZXgpID0+IHtcbiAgICAgIHJlbW92ZWRJbmRleE5hbWVzLnB1c2goZGJTY2hlbWEuaW5kZXhfbmFtZXNbb2JqZWN0SGFzaChyZW1vdmVkSW5kZXgpXSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBhZGRlZE1hdGVyaWFsaXplZFZpZXdzTmFtZXMgPSBfLmZpbHRlcihcbiAgICAgIE9iamVjdC5rZXlzKG5vcm1hbGl6ZWRNb2RlbFNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3MpLFxuICAgICAgKHZpZXdOYW1lKSA9PiAoIV8uaXNFcXVhbChcbiAgICAgICAgbm9ybWFsaXplZERCU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1t2aWV3TmFtZV0sXG4gICAgICAgIG5vcm1hbGl6ZWRNb2RlbFNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3Nbdmlld05hbWVdLFxuICAgICAgKSksXG4gICAgKTtcblxuICAgIGNvbnN0IHJlbW92ZWRNYXRlcmlhbGl6ZWRWaWV3TmFtZXMgPSBfLmZpbHRlcihcbiAgICAgIE9iamVjdC5rZXlzKG5vcm1hbGl6ZWREQlNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3MpLFxuICAgICAgKHZpZXdOYW1lKSA9PiAoIV8uaXNFcXVhbChcbiAgICAgICAgbm9ybWFsaXplZERCU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1t2aWV3TmFtZV0sXG4gICAgICAgIG5vcm1hbGl6ZWRNb2RlbFNjaGVtYS5tYXRlcmlhbGl6ZWRfdmlld3Nbdmlld05hbWVdLFxuICAgICAgKSksXG4gICAgKTtcblxuICAgIGNvbnN0IGFkZGVkTWF0ZXJpYWxpemVkVmlld3MgPSB7fTtcbiAgICBhZGRlZE1hdGVyaWFsaXplZFZpZXdzTmFtZXMuZm9yRWFjaCgodmlld05hbWUpID0+IHtcbiAgICAgIGFkZGVkTWF0ZXJpYWxpemVkVmlld3Nbdmlld05hbWVdID0gbm9ybWFsaXplZE1vZGVsU2NoZW1hLm1hdGVyaWFsaXplZF92aWV3c1t2aWV3TmFtZV07XG4gICAgfSk7XG5cbiAgICAvLyByZW1vdmUgYWx0ZXJlZCBtYXRlcmlhbGl6ZWQgdmlld3NcbiAgICBpZiAocmVtb3ZlZE1hdGVyaWFsaXplZFZpZXdOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gdXRpbC5mb3JtYXQoXG4gICAgICAgICdTY2hlbWEgZm9yIHRhYmxlIFwiJXNcIiBoYXMgcmVtb3ZlZCBtYXRlcmlhbGl6ZWRfdmlld3M6ICVqLCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZHJvcCB0aGVtPycsXG4gICAgICAgIHRhYmxlTmFtZSxcbiAgICAgICAgcmVtb3ZlZE1hdGVyaWFsaXplZFZpZXdOYW1lcyxcbiAgICAgICk7XG4gICAgICBjb25zdCBwZXJtaXNzaW9uID0gdGhpcy5fY29uZmlybV9taWdyYXRpb24obWVzc2FnZSk7XG4gICAgICBpZiAocGVybWlzc2lvbiAhPT0gJ3knKSB7XG4gICAgICAgIGNhbGxiYWNrKGJ1aWxkRXJyb3IoJ21vZGVsLnRhYmxlY3JlYXRpb24uc2NoZW1hbWlzbWF0Y2gnLCB0YWJsZU5hbWUsICdtaWdyYXRpb24gc3VzcGVuZGVkLCBwbGVhc2UgYXBwbHkgdGhlIGNoYW5nZSBtYW51YWxseScpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZHJvcF9tdmlld3MocmVtb3ZlZE1hdGVyaWFsaXplZFZpZXdOYW1lcywgKGVycjIpID0+IHtcbiAgICAgIGlmIChlcnIyKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycjIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChyZW1vdmVkSW5kZXhOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB1dGlsLmZvcm1hdChcbiAgICAgICAgICAnU2NoZW1hIGZvciB0YWJsZSBcIiVzXCIgaGFzIHJlbW92ZWQgaW5kZXhlczogJWosIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkcm9wIHRoZW0/JyxcbiAgICAgICAgICB0YWJsZU5hbWUsXG4gICAgICAgICAgcmVtb3ZlZEluZGV4TmFtZXMsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHBlcm1pc3Npb24gPSB0aGlzLl9jb25maXJtX21pZ3JhdGlvbihtZXNzYWdlKTtcbiAgICAgICAgaWYgKHBlcm1pc3Npb24gIT09ICd5Jykge1xuICAgICAgICAgIGNhbGxiYWNrKGJ1aWxkRXJyb3IoJ21vZGVsLnRhYmxlY3JlYXRpb24uc2NoZW1hbWlzbWF0Y2gnLCB0YWJsZU5hbWUsICdtaWdyYXRpb24gc3VzcGVuZGVkLCBwbGVhc2UgYXBwbHkgdGhlIGNoYW5nZSBtYW51YWxseScpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gcmVtb3ZlIGFsdGVyZWQgaW5kZXhlcyBieSBpbmRleCBuYW1lXG4gICAgICB0aGlzLmRyb3BfaW5kZXhlcyhyZW1vdmVkSW5kZXhOYW1lcywgKGVycjMpID0+IHtcbiAgICAgICAgaWYgKGVycjMpIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnIzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBub3cgYXBwbHkgYWx0ZXJPcGVyYXRpb25zIGhlcmVcbiAgICAgICAgYXN5bmMuZWFjaFNlcmllcyhhbHRlck9wZXJhdGlvbnMsIChhbHRlck9wZXJhdGlvbiwgbmV4dCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHBlcm1pc3Npb24gPSB0aGlzLl9jb25maXJtX21pZ3JhdGlvbihhbHRlck9wZXJhdGlvbi5tZXNzYWdlKTtcbiAgICAgICAgICBpZiAocGVybWlzc2lvbiAhPT0gJ3knKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhidWlsZEVycm9yKCdtb2RlbC50YWJsZWNyZWF0aW9uLnNjaGVtYW1pc21hdGNoJywgdGFibGVOYW1lLCAnbWlncmF0aW9uIHN1c3BlbmRlZCwgcGxlYXNlIGFwcGx5IHRoZSBjaGFuZ2UgbWFudWFsbHknKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuYWx0ZXJfdGFibGUoYWx0ZXJPcGVyYXRpb24ub3BlcmF0aW9uLCBhbHRlck9wZXJhdGlvbi5maWVsZE5hbWUsIGFsdGVyT3BlcmF0aW9uLnR5cGUsIG5leHQpO1xuICAgICAgICB9LCAoZXJyNCkgPT4ge1xuICAgICAgICAgIGlmIChlcnI0KSB7XG4gICAgICAgICAgICBjYWxsYmFjayhlcnI0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBhZGQgYWx0ZXJlZCBpbmRleGVzXG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1uZXN0ZWQtY2FsbGJhY2tzXG4gICAgICAgICAgdGhpcy5jcmVhdGVfaW5kZXhlcyhhZGRlZEluZGV4ZXMsIChlcnI1KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXJyNSkge1xuICAgICAgICAgICAgICBjYWxsYmFjayhlcnI1KTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgYWx0ZXJlZCBjdXN0b20gaW5kZXhlc1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1uZXN0ZWQtY2FsbGJhY2tzXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZV9jdXN0b21faW5kZXhlcyhhZGRlZEN1c3RvbUluZGV4ZXMsIChlcnI2KSA9PiB7XG4gICAgICAgICAgICAgIGlmIChlcnI2KSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyNik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gYWRkIGFsdGVyZWQgbWF0ZXJpYWxpemVkX3ZpZXdzXG4gICAgICAgICAgICAgIHRoaXMuY3JlYXRlX212aWV3cyhhZGRlZE1hdGVyaWFsaXplZFZpZXdzLCBjYWxsYmFjayk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICBpbml0X2FsdGVyX29wZXJhdGlvbnMobW9kZWxTY2hlbWEsIGRiU2NoZW1hLCBub3JtYWxpemVkTW9kZWxTY2hlbWEsIG5vcm1hbGl6ZWREQlNjaGVtYSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBwcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllcztcbiAgICBjb25zdCB0YWJsZU5hbWUgPSBwcm9wZXJ0aWVzLnRhYmxlX25hbWU7XG4gICAgY29uc3QgYWx0ZXJPcGVyYXRpb25zID0gW107XG4gICAgY29uc3QgZGlmZmVyZW5jZXMgPSBkZWVwRGlmZihub3JtYWxpemVkREJTY2hlbWEuZmllbGRzLCBub3JtYWxpemVkTW9kZWxTY2hlbWEuZmllbGRzKTtcbiAgICBsZXQgZHJvcHBlZEZpZWxkcyA9IGZhbHNlO1xuICAgIGFzeW5jLmVhY2hTZXJpZXMoZGlmZmVyZW5jZXMsIChkaWZmLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSBkaWZmLnBhdGhbMF07XG4gICAgICBpZiAoZGlmZi5raW5kID09PSAnTicpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHV0aWwuZm9ybWF0KFxuICAgICAgICAgICdTY2hlbWEgZm9yIHRhYmxlIFwiJXNcIiBoYXMgYWRkZWQgZmllbGQgXCIlc1wiLCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gYWx0ZXIgdG8gYWRkIHRoZSBmaWVsZD8nLFxuICAgICAgICAgIHRhYmxlTmFtZSxcbiAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICk7XG4gICAgICAgIGFsdGVyT3BlcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICBvcGVyYXRpb246ICdBREQnLFxuICAgICAgICAgIHR5cGU6IHBhcnNlci5leHRyYWN0X2FsdGVyZWRfdHlwZShub3JtYWxpemVkTW9kZWxTY2hlbWEsIGRpZmYpLFxuICAgICAgICB9KTtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZGlmZi5raW5kID09PSAnRCcpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHV0aWwuZm9ybWF0KFxuICAgICAgICAgICdTY2hlbWEgZm9yIHRhYmxlIFwiJXNcIiBoYXMgcmVtb3ZlZCBmaWVsZCBcIiVzXCIsIGFsbCBkYXRhIGluIHRoZSBmaWVsZCB3aWxsIGxvc3QsIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBhbHRlciB0byBkcm9wIHRoZSBmaWVsZD8nLFxuICAgICAgICAgIHRhYmxlTmFtZSxcbiAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICk7XG4gICAgICAgIGFsdGVyT3BlcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICBvcGVyYXRpb246ICdEUk9QJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGRyb3BwZWRGaWVsZHMgPSB0cnVlO1xuICAgICAgICBub3JtYWxpemVyLnJlbW92ZV9kZXBlbmRlbnRfdmlld3NfZnJvbV9ub3JtYWxpemVkX3NjaGVtYShub3JtYWxpemVkREJTY2hlbWEsIGRiU2NoZW1hLCBmaWVsZE5hbWUpO1xuICAgICAgICBuZXh0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChkaWZmLmtpbmQgPT09ICdFJykge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgYWx0ZXIgZmllbGQgdHlwZSBpcyBwb3NzaWJsZSwgb3RoZXJ3aXNlIHRyeSBEIGFuZCB0aGVuIE5cbiAgICAgICAgaWYgKGRpZmYucGF0aFsxXSA9PT0gJ3R5cGUnKSB7XG4gICAgICAgICAgLy8gY2hlY2sgaWYgZmllbGQgcGFydCBvZiBwcmltYXJ5IGtleVxuICAgICAgICAgIGlmIChub3JtYWxpemVkREJTY2hlbWEua2V5WzBdLmluY2x1ZGVzKGZpZWxkTmFtZSkgfHwgbm9ybWFsaXplZERCU2NoZW1hLmtleS5pbmRleE9mKGZpZWxkTmFtZSkgPiAwKSB7XG4gICAgICAgICAgICAvLyBhbHRlciBmaWVsZCB0eXBlIGltcG9zc2libGVcbiAgICAgICAgICAgIG5leHQobmV3IEVycm9yKCdhbHRlcl9pbXBvc3NpYmxlJykpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoWyd0ZXh0JywgJ2FzY2lpJywgJ2JpZ2ludCcsICdib29sZWFuJywgJ2RlY2ltYWwnLFxuICAgICAgICAgICAgJ2RvdWJsZScsICdmbG9hdCcsICdpbmV0JywgJ2ludCcsICd0aW1lc3RhbXAnLCAndGltZXV1aWQnLFxuICAgICAgICAgICAgJ3V1aWQnLCAndmFyY2hhcicsICd2YXJpbnQnXS5pbmNsdWRlcyhkaWZmLmxocykgJiYgZGlmZi5yaHMgPT09ICdibG9iJykge1xuICAgICAgICAgICAgLy8gYWx0ZXIgZmllbGQgdHlwZSBwb3NzaWJsZVxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHV0aWwuZm9ybWF0KFxuICAgICAgICAgICAgICAnU2NoZW1hIGZvciB0YWJsZSBcIiVzXCIgaGFzIG5ldyB0eXBlIGZvciBmaWVsZCBcIiVzXCIsIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBhbHRlciB0byB1cGRhdGUgdGhlIGZpZWxkIHR5cGU/JyxcbiAgICAgICAgICAgICAgdGFibGVOYW1lLFxuICAgICAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYWx0ZXJPcGVyYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgIG9wZXJhdGlvbjogJ0FMVEVSJyxcbiAgICAgICAgICAgICAgdHlwZTogZGlmZi5yaHMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGRpZmYubGhzID09PSAnaW50JyAmJiBkaWZmLnJocyA9PT0gJ3ZhcmludCcpIHtcbiAgICAgICAgICAgIC8vIGFsdGVyIGZpZWxkIHR5cGUgcG9zc2libGVcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB1dGlsLmZvcm1hdChcbiAgICAgICAgICAgICAgJ1NjaGVtYSBmb3IgdGFibGUgXCIlc1wiIGhhcyBuZXcgdHlwZSBmb3IgZmllbGQgXCIlc1wiLCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gYWx0ZXIgdG8gdXBkYXRlIHRoZSBmaWVsZCB0eXBlPycsXG4gICAgICAgICAgICAgIHRhYmxlTmFtZSxcbiAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFsdGVyT3BlcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgICBvcGVyYXRpb246ICdBTFRFUicsXG4gICAgICAgICAgICAgIHR5cGU6IGRpZmYucmhzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChkaWZmLmxocyA9PT0gJ3RpbWV1dWlkJyAmJiBkaWZmLnJocyA9PT0gJ3V1aWQnKSB7XG4gICAgICAgICAgICAvLyBhbHRlciBmaWVsZCB0eXBlIHBvc3NpYmxlXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gdXRpbC5mb3JtYXQoXG4gICAgICAgICAgICAgICdTY2hlbWEgZm9yIHRhYmxlIFwiJXNcIiBoYXMgbmV3IHR5cGUgZm9yIGZpZWxkIFwiJXNcIiwgYXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGFsdGVyIHRvIHVwZGF0ZSB0aGUgZmllbGQgdHlwZT8nLFxuICAgICAgICAgICAgICB0YWJsZU5hbWUsXG4gICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhbHRlck9wZXJhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgICAgb3BlcmF0aW9uOiAnQUxURVInLFxuICAgICAgICAgICAgICB0eXBlOiBkaWZmLnJocyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBhbHRlciB0eXBlIGltcG9zc2libGVcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB1dGlsLmZvcm1hdChcbiAgICAgICAgICAgICAgJ1NjaGVtYSBmb3IgdGFibGUgXCIlc1wiIGhhcyBuZXcgdHlwZSBmb3IgZmllbGQgXCIlc1wiLCBhbGwgZGF0YSBpbiB0aGUgZmllbGQgd2lsbCBiZSBsb3N0LCBhcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZHJvcCB0aGUgZmllbGQgJiByZWNyZWF0ZSBpdD8nLFxuICAgICAgICAgICAgICB0YWJsZU5hbWUsXG4gICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhbHRlck9wZXJhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgICAgb3BlcmF0aW9uOiAnRFJPUCcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGFsdGVyT3BlcmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgICBvcGVyYXRpb246ICdBREQnLFxuICAgICAgICAgICAgICB0eXBlOiBwYXJzZXIuZXh0cmFjdF9hbHRlcmVkX3R5cGUobm9ybWFsaXplZE1vZGVsU2NoZW1hLCBkaWZmKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZHJvcHBlZEZpZWxkcyA9IHRydWU7XG4gICAgICAgICAgICBub3JtYWxpemVyLnJlbW92ZV9kZXBlbmRlbnRfdmlld3NfZnJvbV9ub3JtYWxpemVkX3NjaGVtYShub3JtYWxpemVkREJTY2hlbWEsIGRiU2NoZW1hLCBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBhbHRlciB0eXBlIGltcG9zc2libGVcbiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gdXRpbC5mb3JtYXQoXG4gICAgICAgICAgICAnU2NoZW1hIGZvciB0YWJsZSBcIiVzXCIgaGFzIG5ldyB0eXBlIGZvciBmaWVsZCBcIiVzXCIsIGFsbCBkYXRhIGluIHRoZSBmaWVsZCB3aWxsIGJlIGxvc3QsIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkcm9wIHRoZSBmaWVsZCAmIHJlY3JlYXRlIGl0PycsXG4gICAgICAgICAgICB0YWJsZU5hbWUsXG4gICAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhbHRlck9wZXJhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICBmaWVsZE5hbWUsXG4gICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgb3BlcmF0aW9uOiAnRFJPUCcsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYWx0ZXJPcGVyYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgb3BlcmF0aW9uOiAnQUREJyxcbiAgICAgICAgICAgIHR5cGU6IHBhcnNlci5leHRyYWN0X2FsdGVyZWRfdHlwZShub3JtYWxpemVkTW9kZWxTY2hlbWEsIGRpZmYpLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRyb3BwZWRGaWVsZHMgPSB0cnVlO1xuICAgICAgICAgIG5vcm1hbGl6ZXIucmVtb3ZlX2RlcGVuZGVudF92aWV3c19mcm9tX25vcm1hbGl6ZWRfc2NoZW1hKG5vcm1hbGl6ZWREQlNjaGVtYSwgZGJTY2hlbWEsIGZpZWxkTmFtZSk7XG4gICAgICAgICAgbmV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbmV4dCgpO1xuICAgIH0sIChlcnIpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGRyb3BwZWRGaWVsZHMgJiYgdGhpcy5fZXNfYnVpbGRlcikge1xuICAgICAgICB0aGlzLl9lc19idWlsZGVyLmRlbGV0ZV9pbmRleChwcm9wZXJ0aWVzLmtleXNwYWNlLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fYXBwbHlfYWx0ZXJfb3BlcmF0aW9ucyhhbHRlck9wZXJhdGlvbnMsIGRiU2NoZW1hLCBub3JtYWxpemVkTW9kZWxTY2hlbWEsIG5vcm1hbGl6ZWREQlNjaGVtYSwgY2FsbGJhY2spO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fYXBwbHlfYWx0ZXJfb3BlcmF0aW9ucyhhbHRlck9wZXJhdGlvbnMsIGRiU2NoZW1hLCBub3JtYWxpemVkTW9kZWxTY2hlbWEsIG5vcm1hbGl6ZWREQlNjaGVtYSwgY2FsbGJhY2spO1xuICAgIH0pO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUYWJsZUJ1aWxkZXI7XG4iXX0=